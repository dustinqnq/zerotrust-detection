# 更新日志 (CHANGELOG)

## 版本 v2.0.0 - 2025-05-27

### 🎉 重大功能更新

#### 1. **IoT-23数据集解析完全修复**
- ✅ **解决了数据格式解析问题**：正确处理复合字段格式 `(empty) Malicious PartOfAHorizontalPortScan`
- ✅ **修复了字段分割逻辑**：正确分离 `tunnel_parents`、`label` 和 `detailed-label` 字段
- ✅ **实现了真实标签提取**：使用 `label` 字段进行基本分类，`detailed-label` 提供攻击类型详情
- ✅ **数据完整性验证**：成功读取156,103条记录，包含4,536良性样本和151,567恶意样本

#### 2. **平衡数据集策略实现**
- ✅ **智能采样算法**：从高度不平衡数据集(97.1% vs 2.9%)创建完美平衡数据集(50% vs 50%)
- ✅ **分层采样**：训练集和测试集都保持相同的平衡比例
- ✅ **内存优化**：使用float32数据类型，及时清理中间变量
- ✅ **可配置样本数量**：支持自定义每类样本数量(当前设置为500/类)

#### 3. **零信任架构正确实现**
- ✅ **符合论文设计**：所有数据初始标记为unknown，通过算法证明良性/恶意
- ✅ **三阶段检测**：Type-A分类器 + Type-B分类器 + DBSCAN聚类
- ✅ **真实标签保留**：用于最终评估和性能对比
- ✅ **中文输出界面**：便于理解和使用

#### 4. **CSV结果记录系统**
- 🆕 **自动结果记录**：每次测试自动生成详细的CSV报告
- 🆕 **双重保存机制**：
  - 单次结果：`results/test_result_YYYYMMDD_HHMMSS.csv`
  - 汇总文件：`results/all_test_results.csv`
- 🆕 **完整性能指标**：
  - 数据集信息（名称、路径、规模、分布）
  - 训练参数（轮数、批次大小、特征维度）
  - 模型性能（四种分类器准确率、聚类分析）
  - 数据平衡状态和备注信息

### 📊 性能表现

#### 最新测试结果
- **数据集**：CTU-IoT-Malware-Capture-3-1 (156,103样本)
- **平衡后**：1,000样本 (500良性 + 500恶意)
- **训练集**：800样本，**测试集**：200样本
- **特征维度**：27个特征

#### 模型性能指标
| 分类器类型 | 准确率范围 | 最佳表现 |
|-----------|-----------|----------|
| 类型A二分类 | 65.0% - 97.0% | 97.0% |
| 类型A多分类 | 73.5% - 74.0% | 74.0% |
| 类型B二分类 | 50.0% - 72.5% | 72.5% |
| 类型B多分类 | 77.5% - 88.0% | 88.0% |
| DBSCAN聚类 | 6个聚类 | 7.5%-12.5%噪声点 |

### 🔧 技术改进

#### 数据处理优化
- **内存管理**：TensorFlow GPU内存增长控制
- **CPU优化**：限制线程数量避免资源竞争
- **数据类型优化**：使用float32减少内存占用
- **垃圾回收**：及时清理中间变量

#### 代码结构优化
- **模块化设计**：清晰的处理器分离
- **错误处理**：完善的异常处理机制
- **配置灵活性**：可调整的训练参数
- **输出标准化**：统一的中文输出格式

### 🗂️ 文件变更

#### 新增文件
- `CHANGELOG.md` - 详细更新日志
- `OPTIMIZATION_SUMMARY.md` - 优化总结
- `check_labels.py` - 标签检查工具
- `results/` - 测试结果目录
  - `test_result_*.csv` - 单次测试结果
  - `all_test_results.csv` - 汇总测试结果

#### 主要修改
- `src/processors/iot23_processor.py` - 完全重写数据解析逻辑
- `src/test_iot23.py` - 添加平衡采样和CSV记录功能
- `src/zero_trust_ids.py` - 优化内存使用和训练流程

#### 删除文件
- `PROJECT_README.md` - 合并到主README
- `PROJECT_STRUCTURE.md` - 信息过时
- `src/enhanced_multi_stage_detector.py` - 功能重复
- `src/analyze_mirai_protocols.py` - 不再需要

### 🚀 使用方式

```bash
# 运行测试并生成CSV结果
python3 src/test_iot23.py

# 查看测试结果
ls results/
cat results/all_test_results.csv
```

### 🎯 下一步计划

1. **多数据集支持**：扩展到其他IoT-23子数据集
2. **超参数优化**：自动调优训练参数
3. **可视化界面**：添加结果可视化功能
4. **实时检测**：支持流式数据处理
5. **模型部署**：容器化部署方案

### 🐛 已知问题

- TensorFlow警告信息（不影响功能）
- 随机性导致的性能波动（正常现象）

### 👥 贡献者

- 主要开发：AI Assistant
- 测试验证：用户反馈
- 架构设计：基于零信任IoT检测论文

---

**注意**：此版本实现了完整的零信任IoT检测系统，包含数据预处理、平衡采样、三阶段检测和结果记录功能。 